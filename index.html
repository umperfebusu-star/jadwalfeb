<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Kegiatan FEB USU</title>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #0285c7;
    }

    .header {
        background: #3f51b5;
        padding: 17px;
        font-size: 20px;
        font-weight: bold;
        color: white;
        text-align: center;
    }

    .title {
        font-size: 34px;
        font-weight: bold;
        color: white;
        text-align: center;
        margin-top: 35px;
        margin-bottom: 25px;
    }

    .container {
        padding: 20px;
    }

    .inputbox, select {
        width: 100%;
        padding: 15px;
        border-radius: 15px;
        border: none;
        margin-bottom: 12px;
        font-size: 16px;
    }

    .card {
        background: #fffde7;
        padding: 20px;
        margin-bottom: 18px;
        border-radius: 20px;
        font-size: 17px;
        box-shadow: 0px 3px 6px rgba(0,0,0,0.15);
    }

    .hari {
        font-weight: bold;
        font-size: 19px;
    }

    .jam {
        margin-top: 5px;
        font-size: 17px;
    }

    .judul {
        margin-top: 7px;
        font-weight: bold;
        font-size: 18px;
    }

    .tempat {
        margin-top: 5px;
        font-size: 17px;
    }
</style>

</head>
<body>

<div class="header">
    FAKULTAS EKONOMI DAN BISNIS USU
</div>

<div class="title">Jadwal Kegiatan FEB USU</div>

<div class="container">

    <input type="text" id="searchBox" class="inputbox" placeholder="Cari kegiatan, ruangan, atau hari..."/>

    <select id="filterHari" class="inputbox">
        <option value="Semua">Filter: Semua Hari</option>
        <option value="SENIN">Senin</option>
        <option value="SELASA">Selasa</option>
        <option value="RABU">Rabu</option>
        <option value="KAMIS">Kamis</option>
        <option value="JUMAT">Jumat</option>
        <option value="SABTU">Sabtu</option>
        <option value="MINGGU">Minggu</option>
    </select>

    <select id="filterTempat" class="inputbox">
        <option value="Semua">Filter: Semua Tempat</option>
    </select>

    <div id="list"></div>
</div>


<script>
// URL GOOGLE SHEET JSON
const sheetURL = "https://script.google.com/macros/s/AKfycbwpVOjv86huLkyISvEmfgtrnfjDaiBpGL2eF9X53ZtU4ssXIONITQtMj1aXeBgDTIQexg/exec";

// Format tanggal ‚Üí "JUMAT, 28 November 2025"
function formatTanggal(tglStr) {
    const d = new Date(tglStr);
    const hari = ["MINGGU","SENIN","SELASA","RABU","KAMIS","JUMAT","SABTU"];
    const bulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli",
                   "Agustus","September","Oktober","November","Desember"];

    return `${hari[d.getDay()]}, ${d.getDate()} ${bulan[d.getMonth()]} ${d.getFullYear()}`;
}

// Format jam ‚Üí leading zero (09:00), selesai tetap "SELESAI"
function formatJam(jam) {
    if (jam.toString().toUpperCase() === "SELESAI") return "SELESAI";

    let [h, m] = jam.toString().split(":");

    h = h.padStart(2, "0");
    m = m ? m.padStart(2, "0") : "00";

    return `${h}:${m}`;
}


async function load() {
    const res = await fetch(sheetURL);
    const data = await res.json();

    const tempatSet = new Set();
    data.forEach(d => tempatSet.add(d.tempat));

    // Tambahkan tempat ke filter
    const tempatSelect = document.getElementById("filterTempat");
    tempatSet.forEach(t => {
        const op = document.createElement("option");
        op.value = t;
        op.textContent = t;
        tempatSelect.appendChild(op);
    });

    tampil(data);

    document.getElementById("searchBox").addEventListener("input", () => tampil(data));
    document.getElementById("filterHari").addEventListener("change", () => tampil(data));
    document.getElementById("filterTempat").addEventListener("change", () => tampil(data));
}

function tampil(data) {
    const search = document.getElementById("searchBox").value.toLowerCase();
    const fHari = document.getElementById("filterHari").value;
    const fTempat = document.getElementById("filterTempat").value;

    const list = document.getElementById("list");
    list.innerHTML = "";

    data.forEach(d => {

        const tglFix = formatTanggal(d.tanggal);
        const mulai = formatJam(d.waktu_mulai);
        const selesai = formatJam(d.waktu_selesai);

        const jamFix = `${mulai} - ${selesai}`;

        // Filter hari
        if (fHari !== "Semua" && tglFix.split(",")[0] !== fHari) return;

        // Filter tempat
        if (fTempat !== "Semua" && d.tempat !== fTempat) return;

        // Filter search
        const gabungan = (tglFix + " " + jamFix + " " + d.kegiatan + " " + d.tempat).toLowerCase();
        if (!gabungan.includes(search)) return;

        const card = `
            <div class="card">
                <div class="hari">${tglFix}</div>
                <div class="jam">${jamFix}</div>
                <div class="judul">${d.kegiatan}</div>
                <div class="tempat">üìç ${d.tempat}</div>
            </div>
        `;
        list.innerHTML += card;
    });
}

load();
</script>

</body>
</html>
